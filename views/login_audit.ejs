<%- include('partials/header', { pageTitle: 'Login Audit - ' + shopData.shopName }) %>

    <h2>Login Audit</h2>
    <p>Here are the login attempts:</p>
    <table class="audit-table">
        <thead>
            <tr>
                <th scope="col">User</th>
                <th scope="col">Success</th>
                <th scope="col">IP Address</th>
                <th scope="col">Reason</th>
                <th scope="col">Time</th>
                <th scope="col">Operation</th>
            </tr>
        </thead>
        <tbody>
            <% loginAttempts.forEach(attempt=> { %>
                <tr>
                    <td>
                        <%= attempt.username %>
                    </td>
                    <td>
                        <% if (attempt.success) { %>Yes<% } else { %>No<% } %>
                    </td>
                    <td>
                        <%= attempt.ip_address %>
                    </td>
                    <td>
                        <%= attempt.reason %>
                    </td>
                    <td>
                        <%= new Date(attempt.timestamp).toLocaleString('en-GB') %>
                    </td>
                    <td>
                        <form method="post" action="/users/audit/delete/<%= attempt.id %>" style="display:inline"
                            onsubmit="return confirm('Delete this audit record?');">
                            <button type="submit">Delete</button>
                        </form>
                    </td>
                </tr>
                <% }); %>
        </tbody>
    </table>
    <a href="/">Back</a>

    <%- include('partials/footer') %>